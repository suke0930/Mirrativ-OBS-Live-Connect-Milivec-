<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Heart Animation</title>
  <style>
    body {
      background-color: transparent;
    }

    .heart {
      position: absolute;
      display: block;
      width: 50px;
      height: 50px;
      background-repeat: no-repeat;
      background-size: contain;
    }
  </style>
</head>

<body>
  <input type="text" class="link"></input>
  <button onclick="createer()">Drop
    Heart</button>
  <!-- <button onclick="createHeart('https://pbs.twimg.com/media/FvR85A5XsAIhL_G?format=jpg')">Drop Heart2</button> -->
  <script>
    function createHeart(imgUrl) {
      const heart = document.createElement('div');
      heart.classList.add('heart');
      heart.style.backgroundImage = `url(${imgUrl})`;
      heart.style.left = Math.random() * window.innerWidth + 'px';
      heart.style.top = window.innerHeight + 'px';
      heart.style.transform = 'rotate(' + Math.random() * 360 + 'deg)';
      document.body.appendChild(heart);
      const animation = heart.animate([
        { transform: `translateY(-${window.innerHeight + 50}px) rotate(${Math.random() * 360}deg)` },
        { transform: `translateY(${window.innerHeight + 50}px) rotate(${Math.random() * 360}deg)` }
      ], {
        duration: 3000 + Math.random() * 2000,
        easing: 'cubic-bezier(0.455, 0.03, 0.515, 0.955)',
        fill: 'forwards'
      });
      animation.onfinish = () => {
        heart.remove();
      }
    }



    function createer() { //テスト用関数
      const msg = document.querySelector('.link')
      console.log(msg)
      const msg2 = msg.value
      createHeart(msg2);

    }
    function opensocket() {
      const socket = new WebSocket('ws://localhost:4455');//ソケっとの定義
      socket.addEventListener('open', event => {
        console.log('サーバーに接続しました。');
      });

      socket.addEventListener('message', event => {
        if (event.data === 'gift') {
          createHeart();
        }
      });

      socket.addEventListener('error', event => {
        console.error('WebSocket接続エラー:', event);
        setTimeout(() => {
          opensocket();
        }, 3000);

        // alart("サーバ落ちてないこれ？")
      });
    }
  </script>
</body>

</html>